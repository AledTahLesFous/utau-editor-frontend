<app-header [isLoggedIn]="isLoggedIn"></app-header>

<div class="relative w-full min-h-screen px-6 py-12 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-900 dark:to-gray-800 text-center overflow-hidden">

  <!-- Header réutilisable -->


  <!-- Container projet -->
  <div class="relative max-w-lg mx-auto mt-24 text-center font-sans p-6 rounded-3xl shadow-2xl bg-white/20 backdrop-blur-2xl border border-white/30">
    <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white mb-6">Créer un nouveau projet</h2>

    <form (ngSubmit)="createProject()" class="flex flex-col gap-4">

      <input
        type="text"
        [(ngModel)]="name"
        name="name"
        placeholder="Nom du projet"
        required
        class="w-full p-3 text-sm rounded-xl border border-gray-300 dark:border-gray-600 bg-white/70 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-emerald-400"
      />

      <!-- Thumbnail -->
<label class="text-sm font-medium text-gray-900 dark:text-white">
  Image de couverture (thumbnail)
</label>
<input
  type="file"
  (change)="onFileSelected($event)"
  accept="image/*"
  class="w-full p-2 text-sm rounded-xl border border-gray-300 dark:border-gray-600 bg-white/70 dark:bg-gray-800 text-gray-900 dark:text-white"
/>

<!-- Affichage de l’aperçu -->
<img *ngIf="coverFile" [src]="coverFile | filePreview" alt="Aperçu" class="mt-2 w-32 h-32 object-cover rounded-xl mx-auto border border-gray-300" />


      <select [(ngModel)]="primary_voicebank" name="primary_voicebank" class="input-field">
  <option value="" disabled>Sélectionner un voicebank</option>
  <option *ngFor="let vb of voicebanks" [value]="vb.id">{{ vb.name }}</option>
</select>




      <!-- Bouton Advanced Settings -->
      <button
        type="button"
        (click)="showAdvanced = !showAdvanced"
        class="px-4 py-2 rounded-xl font-semibold shadow text-white hover:scale-105 transition-all duration-300 bg-gradient-to-r from-yellow-500 to-yellow-600"
      >
        {{ showAdvanced ? 'Masquer les paramètres avancés' : 'Advanced Settings' }}
      </button>


<!-- Tags -->
<label class="text-sm font-medium text-gray-900 dark:text-white">Tags</label>
<select
  [(ngModel)]="selectedTags"
  name="tags"
  multiple
  class="w-full p-2 text-sm rounded-xl border border-gray-300 dark:border-gray-600 bg-white/70 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-emerald-400"
>
  <option *ngFor="let tag of tagsOptions" [value]="tag.id">{{ tag.name }}</option>
</select>

<!-- Affichage des tags sélectionnés -->
<div class="flex flex-wrap gap-2 mt-1">
  <span *ngFor="let tagId of selectedTags" class="px-2 py-1 bg-emerald-400 text-white text-xs rounded-full">
    {{ getTagName(tagId) }}
  </span>
</div>

      

      <!-- Paramètres avancés -->
      <div *ngIf="showAdvanced" class="flex flex-col gap-3 mt-4 p-4 border border-white/30 rounded-2xl bg-white/10 backdrop-blur-sm">
        <input
          type="text"
          [(ngModel)]="description"
          name="description"
          placeholder="Description du projet"
          class="w-full p-2 text-sm rounded-xl border border-gray-300 dark:border-gray-600 bg-white/70 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-emerald-400"
        />

        <label for="tempo" class="text-sm font-medium text-gray-900 dark:text-white">
          Tempo: <span id="tempo">{{ tempo || 120 }}</span>
        </label>
        <input
          type="range"
          [(ngModel)]="tempo"
          name="tempo"
          min="40"
          max="300"
          step="10"
          value="120"
          (input)="tempo = $any($event.target).value"
          class="w-full accent-emerald-400"
        />


      </div>

      <!-- Boutons -->
      <div class="flex justify-center gap-3 mt-4">
        <button
          type="submit"
          class="px-4 py-2 rounded-xl text-white font-semibold shadow hover:scale-105 transition-all duration-300 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-sm"
        >
          Créer
        </button>

        <button
          type="button"
          (click)="back()"
          class="px-4 py-2 rounded-xl text-white font-semibold shadow hover:scale-105 transition-all duration-300 bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-sm"
        >
          Retour
        </button>
      </div>

    </form>

    <p *ngIf="message" class="mt-4 text-gray-700 dark:text-gray-300">{{ message }}</p>
  </div>
</div>
